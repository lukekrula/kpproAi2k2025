<th:block th:fragment="tree (tasks, program)">
    <ul>
        <li th:each="task : ${tasks}">

            <div class="task-row">

                <!-- Task link -->
                <a th:href="@{/programs/{pid}/tasks/{tid}(pid=${program.id}, tid=${task.id})}">
                    <span th:utext="${task.completed} ? '&#9989;' : '&#10060;'"></span>
                    <strong th:text="${task.name}"></strong>
                </a>

                <!-- Toggle button -->
                <button type="button"
                        th:if="${!#lists.isEmpty(task.subTasks)}"
                        class="toggle-btn"
                        onclick="toggleSubtasks(this)">
                    â–¶
                </button>

            </div>

            <!-- Subtasks -->
            <ul class="subtasks hidden" th:if="${!#lists.isEmpty(task.subTasks)}">
                <li th:each="sub : ${task.subTasks}">
                    <div th:replace="fragments/task-tree :: tree(tasks=${task.subTasks}, program=${program})"></div>
                </li>
            </ul>

        </li>
    </ul>
</th:block>
